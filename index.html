<!doctype html>
<html>

<head>
    <meta charset="utf-8">

    <title>Smarthome</title>

    <link rel="shortcut icon" href="favicon.ico">
    <!-- ######################################################################

        .oooooo..o                     o8o                 .
       d8P'    `Y8                     `"'               .o8
       Y88bo.       .ooooo.  oooo d8b oooo  oo.ooooo.  .o888oo  .oooo.o
        `"Y8888o.  d88' `"Y8 `888""8P `888   888' `88b   888   d88(  "8
            `"Y88b 888        888      888   888   888   888   `"Y88b.
       oo     .d8P 888   .o8  888      888   888   888   888 . o.  )88b
       8""88888P'  `Y8bod8P' d888b    o888o  888bod8P'   "888" 8""888P'
                                             888
                                            o888o
     ###################################################################### -->
<!--     <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script> -->
    <style>
        @font-face {
            font-family: 'PT Sans';
            font-style: normal;
            font-weight: bold;
            src: url('fonts/pts75f_w.eot');
            src: local('PT Sans Bold'), url('fonts/PTS75F_W.woff') format('woff');
        }

        @font-face {
            font-family: 'PT Sans Narrow';
            font-weight: bold;
            src: url('fonts/ptn77f_w.eot');
            src: local('PT Sans Narrow Bold'), url('fonts/PTN77F_W.woff') format('woff');
        }

        .main__greeting {
            font-family: "PT Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
        }
    </style>
    <link href="bootstrap.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="styles.css">
</head>

<!-- ######################################################################

            oooooooooo.                  .o8
            `888'   `Y8b                "888
             888     888  .ooooo.   .oooo888  oooo    ooo
             888oooo888' d88' `88b d88' `888   `88.  .8'
             888    `88b 888   888 888   888    `88..8'
             888    .88P 888   888 888   888     `888'
            o888bood8P'  `Y8bod8P' `Y8bod88P"     .8'
                                              .o..P'
                                              `Y8P'
     ###################################################################### -->
<body class="page">
<div id="root"></div>

<div class="page__wrapper">
    <div class="page__wrapper-content">
        <header class="header">
            <div class="logo header__logo">
                <a href="yandex.ru" class="link logo__ya"></a>
                <a href="#" class="link logo__ya-sub"></a>
            </div>
    <!-- ######################################################################

        ooo        ooooo
        `88.       .888'
         888b     d'888   .ooooo.  ooo. .oo.   oooo  oooo
         8 Y88. .P  888  d88' `88b `888P"Y88b  `888  `888
         8  `888'   888  888ooo888  888   888   888   888
         8    Y     888  888    .o  888   888   888   888
        o8o        o888o `Y8bod8P' o888o o888o  `V88V"V8P'

     ###################################################################### -->
            <nav class="menu">
                <ul class="menu__list">
                    <li class="menu__item">
                        <a href="#" class="link menu__link link_active">Сводка</a>
                    </li>
                    <li class="menu__item">
                        <a href="#" class="link menu__link">Устройства</a>
                    </li>
                    <li class="menu__item">
                        <a href="#" class="link menu__link">Сценарии</a>
                    </li>
                </ul>
            </nav>
            <div class="menu__icon">
                <svg width="16" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <defs>
                        <path d="M0 3.326a.995.995 0 0 1 1-.993h14c.552 0 1 .44 1 .993v.681A.995.995 0 0 1 15 5H1c-.552 0-1-.44-1-.993v-.68zM0 8.66a.995.995 0 0 1 1-.993h14c.552 0 1 .44 1 .993v.68a.995.995 0 0 1-1 .993H1c-.552 0-1-.44-1-.993v-.68zm0 5.333A.995.995 0 0 1 1 13h14c.552 0 1 .44 1 .993v.68a.995.995 0 0 1-1 .994H1c-.552 0-1-.44-1-.993v-.681z" id="a"/>
                    </defs>
                    <use fill="#333" xlink:href="#a" transform="translate(0 -2)" fill-rule="evenodd"/>
                </svg>
            </div>
        </header>
            <!-- ######################################################################

              .oooooo.                             .                             .
             d8P'  `Y8b                          .o8                           .o8
            888           .ooooo.  ooo. .oo.   .o888oo  .ooooo.  ooo. .oo.   .o888oo
            888          d88' `88b `888P"Y88b    888   d88' `88b `888P"Y88b    888
            888          888   888  888   888    888   888ooo888  888   888    888
            `88b    ooo  888   888  888   888    888 . 888    .o  888   888    888 .
             `Y8bood8P'  `Y8bod8P' o888o o888o   "888" `Y8bod8P' o888o o888o   "888"

             ###################################################################### -->
        <main class="content">

            <div class="content__item content__item_half content__item_main">
                <div class="content__item-header">Главное</div>
                <section class="main">
                    <div class="main__info">
                        <div class="main__greeting">Привет, Геннадий!</div>
                        <div class="main__status">Двери и окна закрыты, сигнализация включена.</div>
                        <div class="weather main__weather">
                            <div class="weather__item">
                                <div class="weather__item-title">Дома</div>
                                <div class="weather__item-temp">+23</div>
                            </div>
                            <div class="weather__item weather__item_outside weather__item_cloud-drizzle">
                                <div class="weather__item-title">За окном</div>
                                <div class="weather__item-temp">+19</div>
                            </div>
                        </div>
                    </div>
                    <div class="main__upcoming-wrapper">
                        <div class="main__upcoming">
                            <div class="panel main__panel panel_device panel_first">
                                <div class="panel__icon panel__icon_temp_off"></div>
                                <div class="panel__text">
                                    <div class="panel__title">Philips Cooler</div>
                                    <div class="panel__sub">Начнет охлаждать в 16:30</div>
                                </div>
                            </div>
                            <div class="panel main__panel panel_device">
                                <div class="panel__icon panel__icon_light_off"></div>
                                <div class="panel__text">
                                    <div class="panel__title">Xiaomi Yeelight LED Smart Bulb</div>
                                    <div class="panel__sub">Включится в 17:00</div>
                                </div>
                            </div>
                            <div class="panel main__panel panel_device panel_out_bot">
                                <div class="panel__icon panel__icon_light_off"></div>
                                <div class="panel__text">
                                    <div class="panel__title">Xiaomi Yeelight LED Smart Bulb</div>
                                    <div class="panel__sub">Включится в 17:00</div>
                                </div>
                            </div>
                            <div class="panel main__panel panel_device panel_out_bot">
                                <a target="_blank" href="http://ya.ru"><img src="assets/banner.jpg" border="0"></a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <div class="content__item content__item_half content__item_scenarios">
                <div class="content__item-header">
                    Избранные сценарии
                </div>
                <div class="paginator scenarios__paginator">
                    <div class="paginator__arrow paginator__arrow_disabled paginator__arrow_left">
                        <svg
                                viewBox="0 0 9 16"
                                width="100%"
                                height="16px">
                            <path
                                    fill="currentColor"
                                    fill-rule="evenodd"
                                    d="M8.7 14.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0l-7-7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4L2.4 8l6.3 6.3z"></path>
                        </svg>
                    </div>
                    <div class="paginator__arrow paginator__arrow_right">
                        <svg
                                viewBox="0 0 9 16"
                                width="100%"
                                height="16px">
                            <path
                                    fill="currentColor"
                                    fill-rule="evenodd"
                                    d="M.3 14.3c-.4.4-.4 1.02 0 1.4.38.4 1 .4 1.4 0l7-7c.4-.4.4-1.02 0-1.4l-7-7C1.3-.1.68-.1.3.3c-.4.38-.4 1 0 1.4L6.6 8 .3 14.3z"></path>
                        </svg>
                    </div>
                </div>
                <section class="scenarios">
                    <div class="scenarios__page">
                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Выключить весь свет в доме и во дворе</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_clock"></div>
                            <div class="panel__text">
                                <div class="panel__title">Я ухожу</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Включить свет в корридоре</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_temp_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Набрать горячую ванну</div>
                                <div class="panel__sub">Начнётся в 18:00</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Выключить весь свет в доме и во дворе</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_clock"></div>
                            <div class="panel__text">
                                <div class="panel__title">Я ухожу</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Включить свет в корридоре</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_temp_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Набрать горячую ванну</div>
                                <div class="panel__sub">Начнётся в 18:00</div>
                            </div>
                        </div>

                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Выключить весь свет в доме и во дворе</div>
                            </div>
                        </div>
                    </div>

                    <div class="scenarios__page">
                        <div class="panel scenarios__panel">
                            <div class="panel__icon panel__icon_light_on"></div>
                            <div class="panel__text">
                                <div class="panel__title">Включить свет в корридоре</div>
                            </div>
                        </div>
                    </div>

                    <script type="text/babel">
                        class App extends React.Component {
                            render() {
                                return (
                                    <div class="panel scenarios__panel">
                                        <div class="panel__icon panel__icon_clock"></div>
                                        <div class="panel__text">
                                            <div class="panel__title">Я ухожу</div>
                                        </div>
                                    </div>
                                );
                            }
                        }

                        ReactDOM.render(<App />, document.getElementsByClassName('scenarios__page')[1]);
                    </script>

                </section>
            </div>

            <div class="content__item content__item_devices">
        <span class="content__item-header content__item-header_devices">
          Избранные устройства
        </span>

                <div class="filter__select">
                    <button class="filter__select-button" type="button">
                        <span class="button__text">Все</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="11" height="6">
                            <path d="M10.3 0L5.5 4.7.7 0 0 .7 5.5 6 11 .7z"/>
                        </svg>
                    </button>
                    <div class="filter__select-popup" aria-hidden="true">
                        <div class="filter__select-menu">
                            <div class="filter__select-item filter__select-item_checked" data-group="all">Все</div>
                            <div class="filter__select-item" data-group="kitchen">Кухня</div>
                            <div class="filter__select-item" data-group="room">Зал</div>
                            <div class="filter__select-item" data-group="lamp">Лампочки</div>
                            <div class="filter__select-item" data-group="cam">Камеры</div>
                        </div>
                    </div>
                </div>

                <input class="filter__item-radio filter__item_devices filter__item-radio_all" type="radio" name="filter" id="all" checked>
                <label class="filter__item-label filter__item_devices" for="all">Все</label>
                <input class="filter__item-radio filter__item_devices filter__item-radio_kitchen" type="radio" name="filter" id="kitchen">
                <label class="filter__item-label filter__item_devices" for="kitchen">Кухня</label>
                <input class="filter__item-radio filter__item_devices filter__item-radio_room" type="radio" name="filter" id="room">
                <label class="filter__item-label filter__item_devices" for="room">Зал</label>
                <input class="filter__item-radio filter__item_devices filter__item-radio_lamp" type="radio" name="filter" id="lamp">
                <label class="filter__item-label filter__item_devices" for="lamp">Лампочки</label>
                <input class="filter__item-radio filter__item_devices filter__item-radio_cam" type="radio" name="filter" id="cam">
                <label class="filter__item-label filter__item_devices" for="cam">Камеры</label>

                <div class="paginator devices__paginator">
                    <div class="paginator__arrow paginator__arrow_disabled paginator__arrow_left">
                        <svg
                                viewBox="0 0 9 16"
                                width="100%"
                                height="16px">
                            <path
                                    fill="currentColor"
                                    fill-rule="evenodd"
                                    d="M8.7 14.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0l-7-7c-.4-.4-.4-1 0-1.4l7-7c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4L2.4 8l6.3 6.3z"></path>
                        </svg>
                    </div>

                    <div class="paginator__arrow paginator__arrow_right">
                        <svg
                                viewBox="0 0 9 16"
                                width="100%"
                                height="16px">
                            <path
                                    fill="currentColor"
                                    fill-rule="evenodd"
                                    d="M.3 14.3c-.4.4-.4 1.02 0 1.4.38.4 1 .4 1.4 0l7-7c.4-.4.4-1.02 0-1.4l-7-7C1.3-.1.68-.1.3.3c-.4.38-.4 1 0 1.4L6.6 8 .3 14.3z"></path>
                        </svg>
                    </div>
                </div>

                <section class="devices">
                    <div class="panel panel_device devices__panel panel_room panel_floor">
                        <div class="panel__icon panel__icon_light_on"></div>
                        <div class="panel__text">
                            <div class="panel__title">Xiaomi Warm Floor</div>
                            <div class="panel__sub">Включено</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_lamp">
                        <div class="panel__icon panel__icon_light_on"></div>
                        <div class="panel__text">
                            <div class="panel__title">Xiaomi Yeelight LED Smart Bulb</div>
                            <div class="panel__sub">Включено</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_cam">
                        <div class="panel__icon panel__icon_light_off"></div>
                        <div class="panel__text">
                            <div class="panel__title">D-Link Omna 180 Cam</div>
                            <div class="panel__sub">Включится в 17:00</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_room panel_temp">
                        <div class="panel__icon panel__icon_temp_off"></div>
                        <div class="panel__text">
                            <div class="panel__title">Elgato Eve Degree Connected</div>
                            <div class="panel__sub">Включится в 17:00</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_lamp">
                        <div class="panel__icon panel__icon_light_off"></div>
                        <div class="panel__text">
                            <div class="panel__title">LIFX Mini Day & Dusk A60 E27</div>
                            <div class="panel__sub">Включится в 17:00</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_room">
                        <div class="panel__icon panel__icon_light_on"></div>
                        <div class="panel__text">
                            <div class="panel__title">Xiaomi Mi Air Purifier 2S</div>
                            <div class="panel__sub">Включено</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_lamp">
                        <div class="panel__icon panel__icon_light_off"></div>
                        <div class="panel__text">
                            <div class="panel__title">Philips Zhirui</div>
                            <div class="panel__sub">Выключено</div>
                        </div>
                    </div>
                    <div class="panel panel_device devices__panel panel_kitchen">
                        <div class="panel__icon panel__icon_light_on"></div>
                        <div class="panel__text">
                            <div class="panel__title">Philips Purifier</div>
                            <div class="panel__sub">Включено</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <footer class="footer">
        <a href="#" class="link footer__link">Помощь</a>
        <a href="#" class="link footer__link">Обратная связь</a>
        <a href="#" class="link footer__link">Разработчикам</a>
        <a href="#" class="link footer__link">Условия использования</a>
    </footer>
</div>

<div class="modal modal_temp">
    <div class="modal__content">

        <div class="modal__body">
            <div class="modal__title">Elgato Eve Degree Connected</div>
            <div class="modal__value modal__value_temp">+23</div>
            <div class="modal__status">Включено</div>
            <div class="modal__filter">
                <div class="filter__item-label modal__filter-item_temp" id="manual">Вручную</div>
                <div class="filter__item-label modal__filter-item_temp" id="cold">Холодно</div>
                <div class="filter__item-label modal__filter-item_temp" id="warm">Тепло</div>
                <div class="filter__item-label modal__filter-item_temp" id="hot">Жарко</div>
            </div>
            <div class="adjust-bar__container adjust-bar__container_theme_temp modal__adjust">
                <input class="adjust-bar adjust-bar_theme_temp" type="range" name="lightRange" id="lightRange" value="23" min="-10" max="30" orient="vertical">
            </div>
        </div>

        <div class="modal__controls">
            <div class="button button_size_l button_color_yellow modal__button">Применить</div>
            <div class="button button_size_l modal__button modal_close">Закрыть</div>
        </div>
    </div>

</div>

<div class="modal modal_light">
    <div class="modal__content">

        <div class="modal__body">
            <div class="modal__title">Xiaomi Yeelight LED Smart Bulb</div>
            <div class="modal__value modal__value_light"></div>
            <div class="modal__status">Включено</div>
            <div class="modal__filter">
                <div class="filter__item-label modal__filter-item" id="manual">Вручную</div>
                <div class="filter__item-label modal__filter-item" id="day">Дневной свет</div>
                <div class="filter__item-label modal__filter-item" id="evening">Вечерний свет</div>
                <div class="filter__item-label modal__filter-item" id="dawn">Рассвет</div>
            </div>
            <div class="adjust-bar__container adjust-bar__container_theme_light modal__adjust">
                <input class="adjust-bar adjust-bar_theme_light" type="range" name="tempRange" id="lightRange" value="25" min="0" max="50" orient="vertical">
            </div>
        </div>

        <div class="modal__controls">
            <div class="button button_size_l button_color_yellow modal__button">Применить</div>
            <div class="button button_size_l modal__button modal_close">Закрыть</div>
        </div>
    </div>
</div>
<div class="stats">
</div>

<div class="modal modal_knob">
    <div class="modal__content">

        <div class="modal__body">
            <div class="modal__title">Xiaomi Warm Floor</div>
            <div class="modal__value modal__value_temp">+23</div>
            <div class="modal__status">Включено</div>
            <div class="knob__wrapper">
                <div class="knob">
                    <svg viewBox="-110 -110 220 220" id="foobar">
                        <filter id="knob-shadow">
                            <feGaussianBlur in="SourceAlpha" stdDeviation="2"/>
                            <feOffset dx="2" dy="0" result="offsetblur"/>
                            <feFlood flood-color="rgba(134,121,71,0.45)"/>
                            <feComposite in2="offsetblur" operator="in"/>
                            <feMerge>
                                <feMergeNode/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                        <g class="knob-container">
                            <circle class="knob_center" cx="0" cy="0"/>
                            <circle class="knob__indicator-bg" r="110" cx="0" cy="0" />
                            <circle class="knob__indicator" r="100" cx="0" cy="0"/>
                            <circle class="knob__indicator-mask" r="100" cx="0" cy="0"/>
                            <circle class="knob__indicator-bounds" r="100" cx="0" cy="0"/>
                            <circle class="knob__self" r="89" cx="0" cy="0" />
                            <!-- <polygon class="knob__arrow" points="5,-90 0,-85 10,-85" /> -->
                            <polygon class="knob__arrow" points="-90,0 -85,5 -85,-5" />
                        </g>
                    </svg>
                    <div class="knob__value">+23</div>
                </div>
            </div>
        </div>

        <div class="modal__controls">
            <div class="button button_size_l button_color_yellow modal__button">Применить</div>
            <div class="button button_size_l modal__button modal_close">Закрыть</div>
        </div>
    </div>

</div>


<script>
const output = document.querySelector('.modal__value');
const rangeSLider = document.querySelector('.adjust-bar.adjust-bar_theme_temp');

rangeSLider.oninput = function() {
  output.innerHTML = this.value > 0 ? '+' + this.value : this.value;
}

const arrowLeftDevs = document.querySelector('.devices__paginator .paginator__arrow_left');
const arrowRightDevs = document.querySelector('.devices__paginator .paginator__arrow_right');
const panelCountDevs = document.querySelectorAll('.devices__panel').length;
const devices = document.querySelector('.devices');
const pagiantorDevs = document.querySelector('.devices__paginator');
let currentPageDevs = 1;

pagiantorDevs.classList.toggle('paginator_hide', panelCountDevs < 7);

arrowRightDevs.addEventListener('click', function () {
    currentPageDevs += 1;
    arrowLeftDevs.classList.toggle('paginator__arrow_disabled', currentPageDevs === 1);
    devices.scroll({
      top: 0,
      left: 1366,
      behavior: 'smooth'
    });
});

arrowLeftDevs.addEventListener('click', function () {
  if (currentPageDevs > 1) {
    currentPageDevs -= 1;
    arrowLeftDevs.classList.toggle('paginator__arrow_disabled', currentPageDevs === 1);
    devices.scroll({
      top: 0,
      left: -1366,
      behavior: 'smooth'
    });
  }
});

let curValue;
let curRotate;
let maxRotate = 0.42; // 150 градусов
let minRotate = -0.42; // -150 градусов

const MIN_VALUE = 26;
const MAX_VALUE = 35;
const INDICATOR_OFFSET = 265;

const rotateToValue = function(rotate) {
  return Math.floor((Math.abs(rotate * 360 * 1.73 + INDICATOR_OFFSET) / 53) + MIN_VALUE);
}


/**
 * @param {Number} rotate Количество оборотов от нейтриального положения.
 */
function setRotate(rotate) {
  if (rotate > maxRotate) {
    rotate = maxRotate;
  } else if (rotate < minRotate) {
    rotate = minRotate;
  }

  curRotate = rotate;
  curValue = rotateToValue(rotate);

  document.querySelector('.modal_knob .modal__value').innerHTML = '+' + curValue;
  document.querySelector('.knob__value').innerHTML = '+' + curValue;
  document.querySelector('.knob__indicator').style.strokeDasharray = curRotate * 360 * 1.73 + INDICATOR_OFFSET + ' 629';
  document.querySelector('.knob__arrow').style.transform = 'rotate(' + (curRotate * 360) + 'deg)';
}

function getPosition(elem) {
  const rect = elem.getBoundingClientRect();

  return [
    rect.left + (rect.right - rect.left) / 2,
    rect.top + (rect.bottom - rect.top) / 2
  ];
}

function getMouseAngle(event, centerElem) {
  const pos = getPosition(centerElem);
  let cursor = [event.clientX, event.clientY];
  let rad;

  if (event.targetTouches && event.targetTouches[0]) {
    cursor = [event.targetTouches[0].clientX, event.targetTouches[0].clientY];
  }

  rad = Math.atan2(cursor[1] - pos[1], cursor[0] - pos[0]);
  rad += Math.PI / 2;

  return rad;
}

let knobDragged;
let prevAngleRad = null;
let prevRotate = null;

function startDragging(e) {
  e.preventDefault();
  e.stopPropagation();
  const rad = getMouseAngle(e, document.querySelector('.knob_center'));

  knobDragged = true;
  prevAngleRad = rad;
  prevRotate = curRotate;
}

function stopDragging(e) {
  knobDragged = false;
}

function dragRotate(e) {
  if (!knobDragged) {
    return;
  }

  const old = prevAngleRad;
  let rad = getMouseAngle(e, document.querySelector('.knob_center'));
  let delta = rad - old;

  prevAngleRad = rad;

  if (delta < 0) {
    delta += Math.PI * 2;
  }
  if (delta > Math.PI) {
    delta -= Math.PI * 2;
  }

  const deltaRotate = delta / Math.PI / 2;
  const rotate = prevRotate + deltaRotate;

  prevRotate = rotate;
  setRotate(rotate);
}

function setEvtListeners() {
  const elem = document.querySelector('.knob-container');

  elem.addEventListener('mousedown', startDragging);
  document.addEventListener('mouseup', stopDragging);
  document.addEventListener('mousemove', dragRotate);
  elem.addEventListener('touchstart', startDragging);
  document.addEventListener('touchend', stopDragging);
  document.addEventListener('touchmove', dragRotate);
}

setEvtListeners();
setRotate(0);

document.querySelectorAll('.modal_close').forEach(b => {
  b.onclick = function() {
    document.querySelectorAll('.modal').forEach(m => {
      m.classList.toggle('modal_open', false);
      document.querySelector('body').style.overflow = 'auto';
    });
  }
});

const TEMPS = {
  'manual': -10,
  'cold': 0,
  'warm': 23,
  'hot': 30
}

document.querySelectorAll('.modal__filter-item_temp').forEach(l => {
  l.onclick = function() {
    document.querySelector('.adjust-bar_theme_temp').value = TEMPS[this.id];
    document.querySelector('.modal_temp .modal__value').innerHTML = TEMPS[this.id] > 0 ? '+' + TEMPS[this.id] : TEMPS[this.id];
  }
});

const showModal = function(selector) {
  document.querySelector(selector).classList.toggle('modal_open', true);
  document.querySelector('body').style.overflow = 'hidden';
}

document.querySelectorAll('.panel_temp').forEach(p => {
  p.onclick = function() {
    showModal('.modal_temp');
  }
});

document.querySelectorAll('.panel_lamp').forEach(p => {
  p.onclick = function() {
    showModal('.modal_light');
  }
});

document.querySelectorAll('.panel_floor').forEach(p => {
  p.onclick = function() {
    showModal('.modal_knob');
  }
});

const arrowLeftScens = document.querySelector('.scenarios__paginator .paginator__arrow_left');
const arrowRightScens = document.querySelector('.scenarios__paginator .paginator__arrow_right');
const panelCountScens = document.querySelectorAll('.scenarios__panel').length;
const pageCountScens = document.querySelectorAll('.scenarios__page').length;
const scenarios = document.querySelector('.scenarios');
const pagiantorScens = document.querySelector('.scenarios__paginator');
let currentPage = 1;

pagiantorScens.classList.toggle('paginator_hide', panelCountScens <= 9);

arrowRightScens.addEventListener('click', function () {
  if (currentPage < pageCountScens) {
    currentPage += 1;
    arrowRightScens.classList.toggle('paginator__arrow_disabled', currentPage === pageCountScens);
    arrowLeftScens.classList.toggle('paginator__arrow_disabled', currentPage === 1);
    scenarios.scroll({
      top: 0,
      left: 645,
      behavior: 'smooth'
    });
  }
});

arrowLeftScens.addEventListener('click', function () {
  if (currentPage > 1) {
    currentPage -= 1;
    arrowRightScens.classList.toggle('paginator__arrow_disabled', currentPage === pageCountScens);
    arrowLeftScens.classList.toggle('paginator__arrow_disabled', currentPage === 1);
    scenarios.scroll({
      top: 0,
      left: -645,
      behavior: 'smooth'
    });
  }
});

const selectButton = document.querySelector('.filter__select-button');
const selectButtonText = document.querySelector('.filter__select-button .button__text');
const selectOptions = document.querySelectorAll('.filter__select-item');
const popup = document.querySelector('.filter__select-popup');

selectButton.addEventListener('click', function() {
  popup.classList.toggle('filter__select-popup_open');
});

let widths = '';
window.addEventListener('scroll', function() {
    widths += document.querySelectorAll('body')[0].offsetWidth;
    document.querySelector('.stats').innerHTML = widths;
});

selectOptions.forEach(o => {
  o.addEventListener('click', function(e) {
    document.querySelector('#' + e.target.dataset.group).checked = true;

    selectOptions.forEach(opt => opt.classList.toggle('filter__select-item_checked', false));
    e.target.classList.toggle('filter__select-item_checked', true);
    popup.classList.toggle('filter__select-popup_open', false);
    selectButtonText.innerText = e.target.innerText;
  })
});

document.querySelector('.menu__icon').addEventListener('click', function () {
  document.querySelector('.menu').classList.toggle('menu_open');
});
</script>

</body>

</html>
